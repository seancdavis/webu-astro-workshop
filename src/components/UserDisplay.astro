---
import { getCurrentUserProfile, getUserDisplayName } from '@/utils/auth'

const currentUserProfile = await getCurrentUserProfile()
---

{!currentUserProfile && <a href="/login">Sign in</a>}

{
  currentUserProfile && (
    <div class="flex items-center gap-2">
      <div class="flex items-center gap-2">
        {currentUserProfile.has_avatar && (
          <img
            src="/api/profile/avatar"
            class="w-8 h-8 object-cover rounded-full border-2 border-white"
          />
        )}
        <a href="/user/profile">{getUserDisplayName(currentUserProfile)}</a>
      </div>

      <form action="/api/logout" method="post">
        <button type="submit">Logout</button>
      </form>
    </div>
  )
}
